import { state } from "../state";

export function buildPrompt() {
  const cardMeaning = state.selectedCards
    .map((card, index) => {
      return `
    ${index + 1}. ${card.name}
    - 핵심 의미: [정방향] ${card.meaning_up} / [역방향] ${card.meaning_rev}
    - 카드 설명 및 해석: ${card.desc}
    `;
    })
    .join("\n\n");

  return `
  당신은 전문 타로 리더입니다. 아래 내용을 바탕으로 직관적인 해석을 제공합니다.

  🔹 유저 질문:
  ${state.userQuestion}

  🔹 뽑힌 카드 목록:
  ${cardMeaning}

  🔹 요청:
  - 한국어로 답변해주세요.
  - 유저를 "당신"으로 칭하고, 예의 바르고 부드러운 존댓말로 답변해주세요.
  - 카드는 정방향만을 기준으로 하므로, 의미는 상황에 따라 정방향과 역방향에서 찾을 수 있는 상징과 의미를 종합하여 사용해주세요. '핵심 의미'에는 정방향 의미와 역방향 의미를 전부 적어두었습니다.
  - '카드 설명 및 해석'의 내용을 자세히 읽어 카드를 깊이 이해한 것을 바탕으로 유저의 질문에 대답하세요.
  - 각 카드가 질문에 대해 어떤 통찰을 주는지 해석해주세요.
  - 이후 세 카드를 통합하여 그 흐름이 질문에 대해 어떤 통찰을 주는지 해석해주세요.
  - 전체적인 의미를 종합하여 조언을 주세요. 스토리텔링 방식을 채택해도 좋습니다.
  - 불확실할 경우, 조심스럽고 따뜻한 말투로 전달해주세요.
  `.trim();
}
